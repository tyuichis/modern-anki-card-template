/* modern-anki-card-template
Copyright (C) 2025 Tommy Yuichi Siek

This file is part of modern-anki-card-template.
Licensed under the AGPL-3.0 License.
See the LICENSE file in the project root for details. */

/* ===========================
   CSS Variables (Root Styles)
=========================== */
:root.night-mode,
:root {
  --font-size: 16px;
}

:root {
  --light-mode-main-bg-color: #f3f3f3;
  --dark-mode-main-bg-color: #272626;
  --light-mode-main-text-color: #333333;
  --dark-mode-main-text-color: #d4d4d4; /* original: #ececec */
  --light-mode-footnote-text-color: #666666;
  --dark-mode-footnote-text-color: darkgrey;
  --light-mode-empty-text-color: rgba(0, 0, 0, 0.25);
  --dark-mode-empty-text-color: rgba(255, 255, 255, 0.25);
  --light-mode-details-text-color: #666;
  --dark-mode-details-text-color: darkgrey;
  --light-mode-status-bar-color: rgba(0, 0, 0, 0.8);
  --dark-mode-code-block-background: #0d1116;
  --light-mode-code-block-background: #f9f9f9;
  --light-mode-code-block-border: #d1d1d1;
  --light-mode-link-accent-color: #d91e50;
  --dark-mode-link-accent-color: darkgrey;
  --dark-mode-status-bar-color: rgba(
    255,
    255,
    255,
    0.8
  ); /* original: #49A2D5 */
  --status-bar-accent-color: #49a2d5;
  --title-font-family:
    "SF Pro Rounded", "Noto Sans Rounded", "Roboto Rounded",
    "Hiragino Maru Gothic ProN", Quicksand, Comfortaa, Manjari,
    "Arial Rounded MT Bold", "Arial Rounded MT", Calibri, "Source Sans Pro",
    sans-serif;
  --ios-font-family:
    "SF Pro Rounded", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
    "Helvetica Neue", Arial, sans-serif;
  --monospace-font-family:
    "JetBrainsMono Nerd Font Mono", "JetBrains Mono", "Fira Code", "Menlo",
    "Consolas", "Monaco", monospace;
  --system-font-family:
    -apple-system, BlinkMacSystemFont, "Segoe UI", system-iui, Roboto, Oxygen,
    Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
  --jp-font-family:
    "SF Pro JP", "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Noto Sans JP",
    "Yu Gothic", "Meiryo", sans-serif;
  --android-font-family: "Noto Sans JP", "Noto", "Roboto", sans-serif;
  --label-font-color: #8e8e93; /* replace with JS depending on subject category */
  --label-background-color: rgba(
    44,
    44,
    46,
    0.9
  ); /* replace with JS depending on subject category */
  --flag-color: rgba(255, 255, 255, 0.8);
  --subject-flag-color: rgba(255, 255, 255, 0.8); /* set with JS */
  --dark-mode-ios-link-color: #2997ff;
  --flashcard-content-ideal-max-height: 417px;
  --mac-flashcard-content-ideal-max-height: 478.467px;
  --android-ideal-max-height: min(550px, 60vh);
  --iphone-ideal-max-height: min(450px, 50vh);
  /* pill button */
  --pill-button-padding: 0.25em 1em;
  /* iOS Typography Scale */
  /* Refined iOS Typography Scale */
  /* Title Sizes */
  --ios-font-size-title1: 1.75rem; /* Large title */
  --ios-line-height-title1: 2.125rem;
  --ios-font-size-title2: 1.375rem; /* Medium title */
  --ios-line-height-title2: 1.75rem;
  --ios-font-size-title3: 1.25rem; /* Small title */
  --ios-line-height-title3: 1.5rem;
  /* Headline */
  --ios-font-size-headline: 1rem; /* Primary text emphasis */
  --ios-line-height-headline: 1.375rem;
  /* Body Sizes */
  --ios-font-size-body: 0.9375rem; /* Standard body text */
  --ios-line-height-body: 1.25rem;
  /* Callout */
  --ios-font-size-callout: 0.875rem; /* Secondary information */
  --ios-line-height-callout: 1.125rem;
  /* Subheadline */
  --ios-font-size-subheadline: 0.8125rem; /* Tertiary information */
  --ios-line-height-subheadline: 1.125rem;
  /* Footnote */
  --ios-font-size-footnote: 0.75rem; /* Smallest standard text */
  --ios-line-height-footnote: 1rem;
  /* Caption Sizes */
  --ios-font-size-caption1: 0.6875rem; /* Smallest caption */
  --ios-line-height-caption1: 0.875rem;
  --ios-font-size-caption2: 0.625rem; /* Extremely small caption */
  --ios-line-height-caption2: 0.75rem;
  /* macOS Typography Scale */
  --mac-font-size-title1: 2rem; /* ~32px / 16 */
  --mac-line-height-title1: 2.5rem; /* ~40px / 16 */
  --mac-font-size-title2: 1.5rem; /* 24px / 16 */
  --mac-line-height-title2: 2rem; /* 32px / 16 */
  --mac-font-size-title3: 1.25rem; /* 20px / 16 */
  --mac-line-height-title3: 1.75rem; /* 28px / 16 */
  --mac-font-size-headline: 1.125rem; /* 18px / 16 */
  --mac-line-height-headline: 1.5rem; /* 24px / 16 */
  --mac-font-size-body: 1rem; /* 16px / 16 */
  --mac-line-height-body: 1.625rem; /* 26px / 16 */
  --mac-font-size-callout: 0.9375rem; /* 15px / 16 */
  --mac-line-height-callout: 1.375rem; /* 22px / 16 */
  --mac-font-size-subheadline: 0.875rem; /* 14px / 16 */
  --mac-line-height-subheadline: 1.25rem; /* 20px / 16 */
  --mac-font-size-footnote: 0.75rem; /* 12px / 16 */
  --mac-line-height-footnote: 1.125rem; /* 18px / 16 */
  --mac-font-size-caption1: 0.6875rem; /* 11px / 16 */
  --mac-line-height-caption1: 1rem; /* 16px / 16 */
  --mac-font-size-caption2: 0.625rem; /* 10px / 16 */
  --mac-line-height-caption2: 0.875rem; /* 14px / 16 */
  /* Adjusted Android Typography Scale (Pixel 7) */
  /* --- Material Design 3 Typography --- */
  /* Font: Roboto */
  --md-ref-typeface-plain: "Roboto", sans-serif;
  --md-ref-typeface-brand:
    "Roboto", sans-serif; /* Can be different for branding */
  /* --- Display Styles (Large Text - Optional) --- */
  --md-typescale-display-large-font: var(--md-ref-typeface-brand);
  --md-typescale-display-large-size: 3.5625rem; /* 57px / 16 */
  --md-typescale-display-large-line-height: 4rem; /* 64px / 16 */
  --md-typescale-display-large-weight: 400;
  --md-typescale-display-large-tracking: -0.015625em;
  --md-typescale-display-medium-font: var(--md-ref-typeface-brand);
  --md-typescale-display-medium-size: 2.8125rem; /* 45px / 16 */
  --md-typescale-display-medium-line-height: 3.25rem; /* 52px / 16 */
  --md-typescale-display-medium-weight: 400;
  --md-typescale-display-medium-tracking: 0em;
  --md-typescale-display-small-font: var(--md-ref-typeface-brand);
  --md-typescale-display-small-size: 2.25rem; /* 36px / 16 */
  --md-typescale-display-small-line-height: 2.75rem; /* 44px / 16 */
  --md-typescale-display-small-weight: 400;
  --md-typescale-display-small-tracking: 0em;
  /* --- Headline Styles --- */
  --md-typescale-headline-large-font: var(--md-ref-typeface-brand);
  --md-typescale-headline-large-size: 2rem; /* 32px / 16 */
  --md-typescale-headline-large-line-height: 2.5rem; /* 40px / 16 */
  --md-typescale-headline-large-weight: 400;
  --md-typescale-headline-large-tracking: 0em;
  --md-typescale-headline-medium-font: var(--md-ref-typeface-brand);
  --md-typescale-headline-medium-size: 1.75rem; /* 28px / 16 */
  --md-typescale-headline-medium-line-height: 2.25rem; /* 36px / 16 */
  --md-typescale-headline-medium-weight: 400;
  --md-typescale-headline-medium-tracking: 0.009375em;
  --md-typescale-headline-small-font: var(--md-ref-typeface-brand);
  --md-typescale-headline-small-size: 1.5rem; /* 24px / 16 */
  --md-typescale-headline-small-line-height: 2rem; /* 32px / 16 */
  --md-typescale-headline-small-weight: 400;
  --md-typescale-headline-small-tracking: 0.00625em;
  /* --- Title Styles --- */
  --md-typescale-title-large-font: var(--md-ref-typeface-brand);
  --md-typescale-title-large-size: 1.375rem; /* 22px */
  --md-typescale-title-large-line-height: 1.75rem; /* 28px */
  --md-typescale-title-large-weight: 400;
  --md-typescale-title-large-tracking: 0em;
  --md-typescale-title-medium-font: var(--md-ref-typeface-plain);
  --md-typescale-title-medium-size: 1rem; /* 16px */
  --md-typescale-title-medium-line-height: 1.5rem; /* 24px */
  --md-typescale-title-medium-weight: 500;
  --md-typescale-title-medium-tracking: 0.009375em;
  --md-typescale-title-small-font: var(--md-ref-typeface-plain);
  --md-typescale-title-small-size: 0.875rem; /* 14px */
  --md-typescale-title-small-line-height: 1.25rem; /* 20px */
  --md-typescale-title-small-weight: 500;
  --md-typescale-title-small-tracking: 0.00625em;
  /* --- Body Styles --- */
  --md-typescale-body-large-font: var(--md-ref-typeface-plain);
  --md-typescale-body-large-size: 1rem; /* 16px / 16 */
  --md-typescale-body-large-line-height: 1.5rem; /* 24px / 16 */
  --md-typescale-body-large-weight: 400;
  --md-typescale-body-large-tracking: 0.03125em;
  --md-typescale-body-medium-font: var(--md-ref-typeface-plain);
  --md-typescale-body-medium-size: 0.875rem; /* 14px / 16 */
  --md-typescale-body-medium-line-height: 1.25rem; /* 20px / 16 */
  --md-typescale-body-medium-weight: 400;
  --md-typescale-body-medium-tracking: 0.015625em;
  --md-typescale-body-small-font: var(--md-ref-typeface-plain);
  --md-typescale-body-small-size: 0.75rem; /* 12px / 16 */
  --md-typescale-body-small-line-height: 1rem; /* 16px / 16 */
  --md-typescale-body-small-weight: 400;
  --md-typescale-body-small-tracking: 0.025em;
  /* --- Label Styles --- */
  --md-typescale-label-large-font: var(--md-ref-typeface-plain);
  --md-typescale-label-large-size: 0.875rem; /* 14px */
  --md-typescale-label-large-line-height: 1.25rem; /* 20px */
  --md-typescale-label-large-weight: 500;
  --md-typescale-label-large-tracking: 0.00625em;
  --md-typescale-label-medium-font: var(--md-ref-typeface-plain);
  --md-typescale-label-medium-size: 0.75rem; /* 12px */
  --md-typescale-label-medium-line-height: 1rem; /* 16px */
  --md-typescale-label-medium-weight: 500;
  --md-typescale-label-medium-tracking: 0.03125em;
  --md-typescale-label-small-font: var(--md-ref-typeface-plain);
  --md-typescale-label-small-size: 0.6875rem; /* 11px */
  --md-typescale-label-small-line-height: 1rem; /* 16px */
  --md-typescale-label-small-weight: 500;
  --md-typescale-label-small-tracking: 0.03125em;
  /* furigana */
  --mac-font-size-furigana: 0.625rem; /* ~10px */
  --mac-line-height-furigana: 0.75rem; /* ~12px */
  --ios-font-size-furigana: 0.6875rem; /* ~11px */
  --ios-line-height-furigana: 0.8125rem; /* ~13px */
  --android-font-size-furigana: 0.6875rem; /* ~11px */
  --android-line-height-furigana: 0.8125rem; /* ~13px */
  /* macOS Code Typography Scale */
  --mac-code-font-family:
    ui-monospace, "Cascadia Code", "Source Code Pro", Menlo, Consolas,
    "DejaVu Sans Mono", monospace;
  --mac-code-font-size-large: 1rem; /* ~16px / 16 For larger blocks, headings */
  --mac-code-line-height-large: 1.5rem; /* ~24px / 16 */
  --mac-code-font-size-medium: 0.875rem; /* ~14px / 16 For most inline code, smaller blocks */
  --mac-code-line-height-medium: 1.25rem; /* ~20px / 16 */
  --mac-code-font-size-small: 0.75rem; /* ~12px / 16 For small inline snippets, metadata, etc. */
  --mac-code-line-height-small: 1rem; /* ~16px / 16 */
  /* iOS Code Typography Scale */
  --ios-code-font-family:
    "SF Mono", ui-monospace, Menlo, Consolas, "DejaVu Sans Mono", monospace;
  --ios-code-font-size-large: 1rem; /* ~16px / 16 For larger blocks, headings */
  --ios-code-line-height-large: 1.5rem; /* ~24px / 16 */
  --ios-code-font-size-medium: 0.875rem; /* ~14px / 16 For most inline code, smaller blocks */
  --ios-code-line-height-medium: 1.25rem; /* ~20px / 16 */
  --ios-code-font-size-small: 0.75rem; /* ~12px / 16 For small inline snippets, metadata, etc. */
  --ios-code-line-height-small: 1rem; /* ~16px / 16 */
  /* Android Code Typography Scale */
  --android-code-font-family:
    "Roboto Mono", "Cascadia Code", "Source Code Pro", "DejaVu Sans Mono",
    monospace;
  --android-code-font-size-large: 1rem; /* ~16px / 16 For larger blocks, headings */
  --android-code-line-height-large: 1.5rem; /* ~24px / 16 */
  --android-code-font-size-medium: 0.875rem; /* ~14px / 16 For most inline code, smaller blocks */
  --android-code-line-height-medium: 1.25rem; /* ~20px / 16 */
  --android-code-font-size-small: 0.75rem; /* ~12px / 16 For small inline snippets, metadata, etc. */
  --android-code-line-height-small: 1rem; /* ~16px / 16 */
  --app-width: 478.47px;
  /* take into account button padding, left and right sides */
  --status-bar-width: calc(478.47px + (0.25em * 2));
  --status-bar-mobile-width: calc(90vw + (0.25em * 2));
}

/* ===========================
   Base Styles (Global Settings)
=========================== */
html,
* {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
  font-smooth: always;
}

/* Apply background color to body before content */
.nightMode.card::before, .nightMode.card {
  background: var(--dark-mode-main-bg-color);
  color: var(--dark-mode-main-text-color); /* base text color */
}

.card::before,
.card {
  background: var(--light-mode-main-bg-color);
  color: var(--light-mode-main-text-color);
}

/* ===========================
   Typography (Font Settings)
=========================== */
/* Define fonts globally, if needed later */
.card {
  font-family: var(--system-font-family);
  line-height: var(--ios-line-height-body); /* Default */
}

#title,
#subject {
  font-family: var(--title-font-family);
}

#subject {
  font-size: var(--ios-font-size-footnote); /* Default */
  line-height: var(--ios-line-height-footnote); /* Default */
}

#title {
  margin-top: 0px; /* remove the margin from top of page. */
  margin-bottom: 0rem;
  font-size: var(--ios-font-size-title2); /* Default */
  line-height: var(--ios-line-height-title2); /* Default */
}

.flashcard-content {
  font-size: var(--ios-font-size-body); /* Default */
  line-height: var(--ios-line-height-body); /* Default */
}

.flashcard-metadata {
  font-size: var(--ios-font-size-footnote); /* Default */
  line-height: var(--ios-font-size-footnote); /* Default */
}

/* bold takes accent color */
#flashcard-question:not(.seen) b,
#flashcard-answer b,
.cloze:not(:has(code)),
#details b {
  color: var(--label-font-color);
}

b,
.cloze:not(:has(code)) {
  font-weight: 600; /* semi bold */
}

.nightMode .seen {
  color: var(--dark-mode-main-text-color);
}

.card a {
  color: var(--light-mode-footnote-text-color);
  overflow-wrap: anywhere;
  word-break: break-word;
  white-space: normal;
  line-break: anywhere;
}
.card a:hover {
  color: var(--light-mode-link-accent-color);
  color: #1a73e8;
}
.card.nightMode a {
  color: var(--dark-mode-link-accent-color);
  text-decoration: underline;
}
.card.nightMode a:hover {
  color: #8ab4f8;
}

#flashcard-extra-info p {
  margin: 0;
}

.nightMode #details {
  color: var(--dark-mode-details-text-color);
}

#details {
  color: var(--light-mode-details-text-color);
}

#details-text {
  display: inline;
  text-align: left;
}

code {
  font-family: var(--monospace-font-family);
}

#status-bar {
  font-size: var(--mac-font-size-callout);
  line-height: var(--mac-line-height-callout);
}

/* desktop typography */
.mac body,
.linux:not(.android) body,
.win body {
  font-family: var(--system-font-family);
  line-height: var(--mac-line-height-body);
}

.mac #subject,
.linux:not(.android) #subject,
.win #subject {
  font-size: var(--mac-font-size-footnote);
  line-height: var(--mac-line-height-footnote);
}

.mac #title,
.linux:not(.android) #title,
.win #title {
  font-size: var(--mac-font-size-title2);
  line-height: var(--mac-line-height-title2);
}

.mac #flashcard-content,
.linux:not(.android) #flashcard-content,
.win #flashcard-content {
  font-family: var(--system-font-family);
  font-size: var(--mac-font-size-body);
  line-height: var(--mac-line-height-body);
}

.mac .flashcard-metadata,
.mac #controls-options,
.mac #deck-name-container,
.linux:not(.android) .flashcard-metadata,
.linux:not(.android) #controls-options,
.linux:not(.android) #deck-name-container,
.win .flashcard-metadata,
.win #controls-options,
.win #deck-name-container {
  font-size: var(--mac-font-size-footnote);
  line-height: var(--mac-line-height-footnote);
}

/* Android specific typography styles */
.android body {
  /* Use the complete set of properties from the MD3 scale */
  font: var(--md-typescale-body-medium-font);
  font-size: var(--md-typescale-body-medium-size);
  line-height: var(--md-typescale-body-medium-line-height);
  font-weight: var(--md-typescale-body-medium-weight);
  letter-spacing: var(--md-typescale-body-medium-tracking);
  /* No need to set font-family again if it's already in --md-typescale-body-large-font */
}

.android #subject,
.android #deck-name-container {
  font: var(--md-typescale-label-medium-font);
  font-size: var(--md-typescale-label-medium-size);
  line-height: var(--md-typescale-label-medium-line-height);
  font-weight: var(--md-typescale-label-medium-weight);
  letter-spacing: var(--md-typescale-label-medium-tracking);
}

.android #title {
  margin-top: 0px;
  margin-bottom: 0rem; /*  Consider using consistent spacing (e.g., multiples of 8px) */
  /* Use Headline Small - good for card titles */
  font: var(--md-typescale-headline-small-font);
  font-size: var(--md-typescale-headline-small-size);
  line-height: var(--md-typescale-headline-small-line-height);
  font-weight: var(--md-typescale-headline-small-weight);
  letter-spacing: var(--md-typescale-headline-small-tracking);
}

.android .flashcard-metadata {
  /* Use Label Small - appropriate for metadata */
  font: var(--md-typescale-label-small-font);
  font-size: var(--md-typescale-label-small-size);
  line-height: var(--md-typescale-label-small-line-height);
  font-weight: var(--md-typescale-label-small-weight);
  letter-spacing: var(--md-typescale-label-small-tracking);
}

/* iphone, ipad typography */
.iphone body,
.ipad body {
  font-family: var(--system-font-family);
  font-size: var(--ios-font-size-body);
  line-height: var(--ios-line-height-body);
}

.iphone #subject,
.ipad #subject,
.iphone #deck-name-container,
.ipad #deck-name-container {
  font-size: var(--ios-font-size-footnote);
  line-height: var(--ios-line-height-footnote);
}

.iphone #title,
.ipad #title {
  font-family: var(--system-font-family);
  margin-top: 0px;
  margin-bottom: 0rem;
  font-size: var(--ios-font-size-title2);
  line-height: var(--ios-line-height-title2);
}

.iphone #flashcard-content,
.ipad #flashcard-content {
  font-size: var(--ios-font-size-body);
  line-height: var(--ios-line-height-body);
}

.iphone .flashcard-metadata,
.ipad .flashcard-metadata {
  font-size: var(--ios-font-size-footnote);
  line-height: var(--ios-line-height-footnote);
}

/* furigana */
.mac ruby > rt {
  font-size: var(--mac-font-size-furigana);
  line-height: var(--mac-line-height-furigana);
}

.ios ruby > rt {
  font-size: var(--ios-font-size-furigana);
  line-height: var(--ios-line-height-furigana);
}

.android ruby > rt {
  font-size: var(--android-font-size-furigana);
  line-height: var(--android-line-height-furigana);
}

/* ===========================
   Flashcard Component
=========================== */
#flashcard-content {
  border-radius: 15px;
}

#question-marker,
#question-text,
#answer-text {
  display: inline;
}

#question-text,
#answer-text {
  margin: 0;
}

#flashcard-textbox img {
  max-width: 100%;
  max-height: 15rem;
  width: auto;
  height: auto;
  display: block;
  margin: 1rem auto 0 auto;
  border-radius: 12px;
}

#flashcard-textbox img:last-child {
  margin-bottom: 0; /* if nothing comes after img, no spacing needed */
}

#question-text > img:first-child {
  margin-top: 0;
}

#flashcard-textbox {
  padding: 2.5rem 2rem;
  display: flex;
  flex-direction: column;
  min-height: 250px;
  max-width: 100%;
  box-sizing: border-box; /* Also use in the textbox */
}

#flashcard-content,
#flashcard-textbox {
  flex-grow: 1;
}

#flashcard-title {
  display: flex;
  justify-content: start;
  overflow-x: auto;
  white-space: nowrap;
  flex-shrink: 0;
  margin-bottom: 1.1875rem;
}

#flashcard-content {
  max-height: var(--flashcard-content-ideal-max-height);
  overflow-y: auto;
  display: flex;
  box-sizing: border-box; /* use box-sizing in the content */
  padding: 0; /* add back the padding, here */
  margin: 0; /* remove the margin */
}

#flashcard-info {
  display: flex;
  flex-flow: column;
  gap: 1.1875rem;
}

#details {
  display: flex;
  justify-content: flex-start;
  align-items: flex-start;
  gap: 0.75em;
}

#flashcard-textbox > *:last-child {
  padding-bottom: 1.25rem;
}

#details-text {
  max-width: 100%; /* contain code blocks */
}

#details-text:has(> pre:only-of-type) pre {
  margin: 0;
}

/* center images for img-only cloze types */
.cloze:has(img:only-child),
.cloze-inactive:has(img:only-child) {
  display: flex;
  flex-flow: row;
  justify-content: center;
  align-items: center;
}

/* center text if user is using only img cloze + text */
.cloze:has(img:only-child) ~ .cloze-inactive,
.cloze-inactive:has(img:only-child) ~ .cloze {
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center; /* This will center the text */
}

/* focus on answer on question-answer cards */
.seen {
  opacity: 0.7;
}

/* not supported for mobile */
.android #misc-info,
.iphone #misc-info,
.ipad #misc-info {
  display: none;
}

/* animations */
/* ANSWER TEXT */
#flashcard-answer {
  animation: answerReveal 0.4s ease-out forwards;
}

@keyframes answerReveal {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
@keyframes fadeInSmooth {
  from {
    opacity: 0;
    filter: brightness(0.85);
    transform: translateY(2px);
  }
  to {
    opacity: 1;
    filter: brightness(1);
    transform: translateY(0);
  }
}
@keyframes popIn {
  from {
    opacity: 0;
    transform: translateY(4px) scale(0.98);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}
/* CLOZE TEXT */
.cloze-answer .cloze {
  display: inline-block;
  opacity: 0;
  filter: brightness(0.85);
  transform: translateY(2px); /* Tiny lift */
  animation: fadeInSmooth 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

/* DETAIL BLOCK */
#flashcard-details-info,
#details {
  opacity: 0;
  transform: translateY(4px) scale(0.98);
  animation: popIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) 0.25s forwards;
}

/* ===========================
  Icons
=========================== */
:root {
  --light-mode-icon-color: #333333;
  --dark-mode-icon-color: darkgray;
  /* bookmark / source icon color accent; none on dark mode */
  --source-icon-accent-color: #b55a5a;
}

/* japanese icons, and deck-related icons*/
/* resize icons */
#flashcard-details-info [class$=-icon] svg,
#flashcard-details-info [id$=-icon] svg {
  width: 1.35rem;
  height: 1.35rem;
}

#flashcard-info [class$=-icon] svg,
#flashcard-info [id$=-icon] svg,
#deck-name-container [class$=-icon] svg,
#deck-name-container [id$=-icon] svg {
  width: 1.75em;
  height: 1.75em;
}

.iphone #flashcard-info [class$=-icon] svg,
.iphone #flashcard-info [id$=-icon] svg,
.iphone #deck-name-container [class$=-icon] svg,
.iphone #deck-name-container [id$=-icon] svg {
  width: 1.5em;
  height: 1.5em;
}

#flashcard-textbox [class$=-icon] svg,
#flashcard-textbox [id$=-icon] svg {
  width: 1.25em;
  height: 1.25em;
}

.nightMode #answer-icon path,
.nightMode #sentence-icon path,
.nightMode #pitch-icon path,
.nightMode .deck-icon path,
.nightMode #source-icon path,
.nightMode #details-icon path {
  fill: var(--dark-mode-icon-color);
}

#answer-icon path,
#sentence-icon path,
#pitch-icon path,
.deck-icon path,
#source-icon path,
#details-icon path {
  fill: var(--light-mode-icon-color);
}

.deck-icon {
  display: flex;
  justify-content: center;
  align-items: center;
}

#details-icon {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.5rem;
  margin-top: 0.085em;
}

/* answer marker icon */
#answer-icon {
  display: flex;
  align-items: center;
}

/* dynamic icons */
/* use outline or filled depending on device or state */
.dynamic-icon {
  display: flex;
  align-items: center;
}

.dynamic-icon::before {
  content: "";
  background-repeat: no-repeat;
  background-size: contain;
  width: 1.75em;
  height: 1.75em;
  display: inline-block;
}

#source-text:empty::before {
  content: "n/a";
}

.nightMode #flashcard-source-info:has(#source-text:empty) #source-icon::before {
  background-image: url("data:image/svg+xml,%3Csvg width='56' height='56' viewBox='0 0 56 56' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%23A9A9A9' d='M12.016 53.16c1.218 0 1.922-.61 4.289-2.976L27.672 38.84c.117-.094.234-.188.328-.188c.117 0 .21.094.328.188l11.39 11.344c2.321 2.32 3.071 2.976 4.266 2.976c1.477 0 2.602-.89 2.602-3.023V10.176c0-4.875-2.414-7.336-7.266-7.336H16.68c-4.828 0-7.266 2.46-7.266 7.336v39.96c0 2.134 1.149 3.024 2.602 3.024m1.757-5.695c-.328.328-.585.234-.585-.211V10.246c0-2.344 1.265-3.633 3.703-3.633h22.242c2.437 0 3.68 1.29 3.68 3.633v37.008c0 .445-.258.516-.587.21L29.173 34.552c-.399-.422-.82-.54-1.172-.54c-.328 0-.75.118-1.172.54Z'/%3E%3C/svg%3E");
}

#flashcard-source-info:has(#source-text:empty) #source-icon::before {
  background-image: url("data:image/svg+xml,%3Csvg width='56' height='56' viewBox='0 0 56 56' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%23666666' d='M12.016 53.16c1.218 0 1.922-.61 4.289-2.976L27.672 38.84c.117-.094.234-.188.328-.188c.117 0 .21.094.328.188l11.39 11.344c2.321 2.32 3.071 2.976 4.266 2.976c1.477 0 2.602-.89 2.602-3.023V10.176c0-4.875-2.414-7.336-7.266-7.336H16.68c-4.828 0-7.266 2.46-7.266 7.336v39.96c0 2.134 1.149 3.024 2.602 3.024m1.757-5.695c-.328.328-.585.234-.585-.211V10.246c0-2.344 1.265-3.633 3.703-3.633h22.242c2.437 0 3.68 1.29 3.68 3.633v37.008c0 .445-.258.516-.587.21L29.173 34.552c-.399-.422-.82-.54-1.172-.54c-.328 0-.75.118-1.172.54Z'/%3E%3C/svg%3E");
}

.nightMode #source-icon::before {
  background-image: url("data:image/svg+xml,%3Csvg width='56' height='56' viewBox='0 0 56 56' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%23A9A9A9' d='M12.016 53.16c1.218 0 1.851-.68 4.289-2.976l10.547-10.125c.539-.493.82-.633 1.148-.633s.656.164 1.148.633l11.977 11.53c.938.892 1.664 1.571 2.86 1.571c1.476 0 2.6-.89 2.6-3.023V10.176c0-4.875-2.413-7.336-7.265-7.336H16.68c-4.828 0-7.266 2.46-7.266 7.336v39.96c0 2.134 1.149 3.024 2.602 3.024'/%3E%3C/svg%3E");
}

#source-icon::before {
  background-image: url("data:image/svg+xml,%3Csvg width='56' height='56' viewBox='0 0 56 56' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%23b55a5a' d='M12.016 53.16c1.218 0 1.851-.68 4.289-2.976l10.547-10.125c.539-.493.82-.633 1.148-.633s.656.164 1.148.633l11.977 11.53c.938.892 1.664 1.571 2.86 1.571c1.476 0 2.6-.89 2.6-3.023V10.176c0-4.875-2.413-7.336-7.265-7.336H16.68c-4.828 0-7.266 2.46-7.266 7.336v39.96c0 2.134 1.149 3.024 2.602 3.024'/%3E%3C/svg%3E");
}

#source-icon {
  align-self: flex-start;
}

.nightMode #subdeck-icon::before {
  background-image: url("data:image/svg+xml,%3Csvg width='56' height='56' viewBox='0 0 56 56' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%23A9A9A9' d='M12.695 4.656h30.633c-.14-1.968-1.266-3.023-3.422-3.023H16.117c-2.156 0-3.281 1.055-3.422 3.023m-4.594 6.492h39.844c-.351-2.132-1.383-3.304-3.726-3.304H11.805c-2.344 0-3.352 1.172-3.703 3.304m2.133 43.22H45.79c4.875 0 7.336-2.438 7.336-7.266V22.21c0-4.828-2.46-7.266-7.336-7.266H10.234c-4.898 0-7.36 2.414-7.36 7.266V47.1c0 4.829 2.462 7.266 7.36 7.266m.07-3.774c-2.343 0-3.656-1.266-3.656-3.703V22.398c0-2.437 1.313-3.68 3.657-3.68h35.414c2.32 0 3.632 1.243 3.632 3.68v24.493c0 2.437-1.312 3.703-3.632 3.703Z'/%3E%3C/svg%3E");
}

.nightMode #remaining-cards-icon::before {
  background-image: url("data:image/svg+xml,%3Csvg width='56' height='56' viewBox='0 0 56 56' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%23A9A9A9' d='m11.83 46.622l.59-.102v1.159c0 4.187 2.114 6.301 6.382 6.301h30.815c4.25 0 6.383-2.114 6.383-6.301V26.072c0-4.167-2.134-6.281-6.383-6.281h-4.756l-1.2-6.911c-.73-4.127-3.21-5.834-7.378-5.102L5.935 13.144Q-.375 14.24.752 20.462l3.7 21.058c.752 4.126 3.19 5.834 7.378 5.102m-4.187-5.854L4.004 20.055c-.386-2.073.55-3.354 2.541-3.7l30.267-5.345c1.971-.346 3.293.548 3.659 2.622l1.097 6.159H18.802c-4.268 0-6.382 2.093-6.382 6.28v17.116l-1.098.203c-2.012.346-3.313-.549-3.68-2.622m11.2 9.94c-2.033 0-3.15-1.098-3.15-3.212V26.255c0-2.114 1.117-3.192 3.15-3.192h30.734c1.992 0 3.15 1.078 3.15 3.192v21.241c0 2.114-1.158 3.212-3.15 3.212Z'/%3E%3C/svg%3E");
}

#remaining-cards-icon::before {
  background-image: url("data:image/svg+xml,%3Csvg width='56' height='56' viewBox='0 0 56 56' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%23666666' d='m11.83 46.622l.59-.102v1.159c0 4.187 2.114 6.301 6.382 6.301h30.815c4.25 0 6.383-2.114 6.383-6.301V26.072c0-4.167-2.134-6.281-6.383-6.281h-4.756l-1.2-6.911c-.73-4.127-3.21-5.834-7.378-5.102L5.935 13.144Q-.375 14.24.752 20.462l3.7 21.058c.752 4.126 3.19 5.834 7.378 5.102m-4.187-5.854L4.004 20.055c-.386-2.073.55-3.354 2.541-3.7l30.267-5.345c1.971-.346 3.293.548 3.659 2.622l1.097 6.159H18.802c-4.268 0-6.382 2.093-6.382 6.28v17.116l-1.098.203c-2.012.346-3.313-.549-3.68-2.622m11.2 9.94c-2.033 0-3.15-1.098-3.15-3.212V26.255c0-2.114 1.117-3.192 3.15-3.192h30.734c1.992 0 3.15 1.078 3.15 3.192v21.241c0 2.114-1.158 3.212-3.15 3.212Z'/%3E%3C/svg%3E");
}

#subdeck-icon::before {
  background-image: url("data:image/svg+xml,%3Csvg width='56' height='56' viewBox='0 0 56 56' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%23666666' d='M12.695 4.656h30.633c-.14-1.968-1.266-3.023-3.422-3.023H16.117c-2.156 0-3.281 1.055-3.422 3.023m-4.594 6.492h39.844c-.351-2.132-1.383-3.304-3.726-3.304H11.805c-2.344 0-3.352 1.172-3.703 3.304m2.133 43.22H45.79c4.875 0 7.336-2.438 7.336-7.266V22.21c0-4.828-2.46-7.266-7.336-7.266H10.234c-4.898 0-7.36 2.414-7.36 7.266V47.1c0 4.829 2.462 7.266 7.36 7.266m.07-3.774c-2.343 0-3.656-1.266-3.656-3.703V22.398c0-2.437 1.313-3.68 3.657-3.68h35.414c2.32 0 3.632 1.243 3.632 3.68v24.493c0 2.437-1.312 3.703-3.632 3.703Z'/%3E%3C/svg%3E");
}

.iphone #subdeck-icon::before,
.ipad #subdeck-icon::before,
.android #subdeck-icon::before {
  height: 1.5em;
  width: 1.5em;
  background-image: url("data:image/svg+xml,%3Csvg width='56' height='56' viewBox='0 0 56 56' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%23666666' d='M13.164 4.656h30.164c-.14-1.968-1.266-3.023-3.422-3.023h-23.32c-2.156 0-3.281 1.055-3.422 3.023m-5.062 6.492h39.843c-.351-2.132-1.383-3.304-3.726-3.304H11.805c-2.344 0-3.352 1.172-3.703 3.304m2.132 43.22H45.79c4.875 0 7.336-2.438 7.336-7.266V22.21c0-4.828-2.46-7.266-7.336-7.266H10.234c-4.898 0-7.36 2.414-7.36 7.266V47.1c0 4.829 2.462 7.266 7.36 7.266'/%3E%3C/svg%3E");
}
.iphone .nightMode #subdeck-icon::before,
.ipad .nightMode #subdeck-icon::before,
.android .nightMode #subdeck-icon::before {
  background-image: url("data:image/svg+xml,%3Csvg width='56' height='56' viewBox='0 0 56 56' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%23A9A9A9' d='M13.164 4.656h30.164c-.14-1.968-1.266-3.023-3.422-3.023h-23.32c-2.156 0-3.281 1.055-3.422 3.023m-5.062 6.492h39.843c-.351-2.132-1.383-3.304-3.726-3.304H11.805c-2.344 0-3.352 1.172-3.703 3.304m2.132 43.22H45.79c4.875 0 7.336-2.438 7.336-7.266V22.21c0-4.828-2.46-7.266-7.336-7.266H10.234c-4.898 0-7.36 2.414-7.36 7.266V47.1c0 4.829 2.462 7.266 7.36 7.266'/%3E%3C/svg%3E");
}

/* ===========================
   Metadata Component
=========================== */
/* Flashcard metadata container */
.flashcard-metadata {
  display: flex;
  gap: 0.5rem;
  width: 100%;
  align-items: center;
}

.nightMode .flashcard-metadata,
.nightMode #deck-name-container {
  color: var(--dark-mode-footnote-text-color);
}

.flashcard-metadata,
#deck-name-container {
  color: var(--light-mode-footnote-text-color);
}

/* label */
.subject-label {
  color: var(--label-font-color);
  background: var(--label-background-color);
  padding: 0.3em 0.5em;
  padding: var(--pill-button-padding);
  border-radius: 6px;
}

/* disable remaining cards for now on mobile, due to breaking api changes */
.android #deck-remaining-cards-container,
.iphone #deck-remaining-cards-container,
.ipad #deck-remaining-cards-container {
  display: none;
}

#flashcard-source-info:has(#source-text:empty) {
  opacity: 0.5;
}

#source-icon path {
  fill: var(--source-icon-accent-color);
}

#flashcard-source-info {
  margin-top: 2.875rem;
}

#source-text {
  overflow-x: auto;
}

#deck-name-container {
  display: flex;
  justify-content: flex-start;
  align-items: center;
  flex-flow: row wrap;
  gap: 0.5rem;
  padding: 0.25rem 0;
}

#flashcard-labels {
  display: flex;
  flex-flow: row wrap;
  justify-content: start;
  align-items: center;
  gap: 0.5em;
  margin-bottom: 1.6875rem;
}

#flashcard-details-info {
  margin-top: 1.25rem;
  display: flex;
  align-items: center;
  gap: 0.5em;
  flex-wrap: wrap;
}

/* align icons */
#flashcard-details-info > * {
  display: flex;
  align-items: center;
  flex-flow: row wrap;
  gap: 0.75em;
}

/* ===========================
   Status Bar Component
=========================== */
.nightMode #status-bar {
  color: var(--dark-mode-status-bar-color);
}

#status-bar {
  display: flex;
  justify-content: space-between;
  box-sizing: border-box;
  color: var(--light-mode-status-bar-color);
}

#status-bar li {
  list-style: none;
}

/* status buttons */
/* align the icon and text */
#undo-button,
#flag-button {
  justify-content: center;
  display: flex;
  height: fit-content;
  flex-flow: nowrap;
  box-sizing: border-box;
  gap: 0.5625em;
}

#flag-button {
  padding-right: 0; /* remove the padding, just for flag. */
}

#flag-button,
#undo-button {
  align-items: center;
}

#flag-icon,
#undo-icon {
  display: flex;
  justify-content: center;
}

.nightMode #undo-button path {
  fill: var(--dark-mode-status-bar-color);
}

#undo-button path {
  fill: var(--light-mode-status-bar-color);
}

/* 
#flag-button path {
  fill: var(--flag-color);
}
*/
/* General Flag Button Styling */
#flag-button {
  cursor: pointer;
}

/* Default (Unflagged) State */
.nightMode #flag-button:not(.flagged) #flag-icon path {
  fill: var(--dark-mode-status-bar-color);
}

#flag-button:not(.flagged) #flag-icon path {
  fill: var(--light-mode-status-bar-color);
}

/* Flagged States */
/* colors synced with "fontColor" in _labelColors.json,  */
/* some colors need to be re-tested, as flag colors look too dark */
/* for now, the color system is here */
:root {
  --dark-mode-flag-yellow: #ffc533;
  --light-mode-flag-yellow: #b28b20;
  --dark-mode-flag-red: #ff6161;
  --light-mode-flag-red: #b24c4c;
  --dark-mode-flag-blue: #57c1ff;
  --light-mode-flag-blue: #2d72d9;
  --dark-mode-flag-green: #59d499;
  --light-mode-flag-green: #3a805a;
  --dark-mode-flag-orange: #ff9f0b;
  --light-mode-flag-orange: #b25f1e;
  --dark-mode-flag-pink: #ff86b5;
  --light-mode-flag-pink: #b24863;
  --dark-mode-flag-turquoise: #40e0d0;
  --light-mode-flag-turquoise: #2a716b;
  --dark-mode-flag-purple: #b19cd9;
  --light-mode-flag-purple: #6b42c7;
  --dark-mode-flag-default: #cccccc;
  --light-mode-flag-default: #444444;
}

.nightMode #flag-button #dropdown-menu .flag-yellow path,
.nightMode #flag-button.flag-yellow #flag-icon path,
.nightMode #flag-button.flag-yellow:hover #flag-icon path {
  fill: var(--dark-mode-flag-yellow);
}
.nightMode #flag-button #dropdown-menu .flag-red path,
.nightMode #flag-button.flag-red #flag-icon path,
.nightMode #flag-button.flag-red:hover #flag-icon path {
  fill: var(--dark-mode-flag-red);
}
.nightMode #flag-button #dropdown-menu .flag-blue path,
.nightMode #flag-button.flag-blue #flag-icon path,
.nightMode #flag-button.flag-blue:hover #flag-icon path {
  fill: var(--dark-mode-flag-blue);
}
.nightMode #flag-button #dropdown-menu .flag-green path,
.nightMode #flag-button.flag-green #flag-icon path,
.nightMode #flag-button.flag-green:hover #flag-icon path {
  fill: var(--dark-mode-flag-green);
}
.nightMode #flag-button #dropdown-menu .flag-orange path,
.nightMode #flag-button.flag-orange #flag-icon path,
.nightMode #flag-button.flag-orange:hover #flag-icon path {
  fill: var(--dark-mode-flag-orange);
}
.nightMode #flag-button #dropdown-menu .flag-pink path,
.nightMode #flag-button.flag-pink #flag-icon path,
.nightMode #flag-button.flag-pink:hover #flag-icon path {
  fill: var(--dark-mode-flag-pink);
}
.nightMode #flag-button #dropdown-menu .flag-turquoise path,
.nightMode #flag-button.flag-turquoise #flag-icon path,
.nightMode #flag-button.flag-turquoise:hover #flag-icon path {
  fill: var(--dark-mode-flag-turquoise);
}
.nightMode #flag-button #dropdown-menu .flag-purple path,
.nightMode #flag-button.flag-purple #flag-icon path,
.nightMode #flag-button.flag-purple:hover #flag-icon path {
  fill: var(--dark-mode-flag-purple);
}
.nightMode #flag-button #dropdown-menu .flag-default path,
.nightMode #flag-button.flag-default #flag-icon path,
.nightMode #flag-button.flag-default:hover #flag-icon path {
  fill: var(--dark-mode-flag-default);
}

/* light mode flags */
#flag-button #dropdown-menu .flag-yellow path,
#flag-button.flag-yellow #flag-icon path {
  fill: var(--light-mode-flag-yellow);
}

#flag-button #dropdown-menu .flag-red path,
#flag-button.flag-red #flag-icon path {
  fill: var(--light-mode-flag-red);
}

#flag-button #dropdown-menu .flag-blue path,
#flag-button.flag-blue #flag-icon path {
  fill: var(--light-mode-flag-blue);
}

#flag-button #dropdown-menu .flag-green path,
#flag-button.flag-green #flag-icon path {
  fill: var(--light-mode-flag-green);
}

#flag-button #dropdown-menu .flag-orange path,
#flag-button.flag-orange #flag-icon path {
  fill: var(--light-mode-flag-orange);
}

#flag-button #dropdown-menu .flag-pink path,
#flag-button.flag-pink #flag-icon path {
  fill: var(--light-mode-flag-pink);
}

#flag-button #dropdown-menu .flag-turquoise path,
#flag-button.flag-turquoise #flag-icon path {
  fill: var(--light-mode-flag-turquoise);
}

#flag-button #dropdown-menu .flag-purple path,
#flag-button.flag-purple #flag-icon path {
  fill: var(--light-mode-flag-purple);
}

#flag-button #dropdown-menu .flag-default path,
#flag-button.flag-default #flag-icon path {
  fill: var(--light-mode-flag-default);
}

/* button hover styling */
#flag-button:hover,
#undo-button:hover {
  border-radius: 5px;
  box-sizing: border-box;
  cursor: pointer;
}

#undo-button:hover {
  color: var(--label-font-color);
}

#undo-button:hover path {
  fill: var(--label-font-color);
}

#status-bar-buttons {
  display: flex;
  justify-content: space-between;
  margin: 0;
  padding: 0;
}

/* not supported for mobile */
.android #status-bar-buttons,
.iphone #status-bar-buttons,
.ipad #status-bar-buttons {
  display: none;
}

#flag-button {
  flex-flow: column;
}

.flag-dropdown-icon svg {
  width: 1.5em;
  height: 1.5em;
}

#flag-button-container {
  display: flex;
  gap: 0.5625em;
  align-items: center;
  align-self: end;
}

#dropdown-menu {
  display: none; /* Hidden by default */
  position: relative;
  border-radius: 5px;
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
  min-width: 160px;
  z-index: 1;
  padding: 0;
  list-style-type: none; /* Remove list item markers */
}

#dropdown-menu .dropdown-item {
  display: flex;
  padding: 0.25em;
  margin: 0;
  border: none;
  background: none;
  text-align: left;
  max-width: 100%;
  background: #f7f7f8;
}

#dropdown-menu .dropdown-item:hover {
  border: none;
}

/* Show the dropdown menu when hovering over the parent */
#flag-button:hover #dropdown-menu {
  display: flex;
  flex-flow: column;
}

#dropdown-menu .dropdown-button {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  padding: 0.75em;
  margin: 0;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  background-color: #f7f7f8;
  box-shadow: none;
}

#dropdown-menu .dropdown-button:hover {
  background: #EAEAEA;
}

.dropdown-item:first-child,
.dropdown-item:first-child button {
  border-radius: 5px 5px 0 0;
}

.dropdown-item:last-child,
.dropdown-item:last-child button {
  border-radius: 0 0 5px 5px;
}

#dropdown-menu #flag-text-container {
  display: flex;
  gap: 0.75em;
  align-items: center;
}

.nightMode #dropdown-menu .dropdown-item {
  background: #1a1a1a;
}
.nightMode #dropdown-menu .dropdown-button {
  background: #1a1a1a;
  border: none;
}
.nightMode #dropdown-menu .dropdown-button:hover {
  background: #1f1f1f;
  border-radius: 5px;
}
.nightMode #dropdown-menu .dropdown-text {
  color: var(--dark-mode-main-text-color);
}
.nightMode #dropdown-menu .dropdown-control {
  color: #d9d9d9;
  border: none;
}

#dropdown-menu .dropdown-text {
  color: #555;
}

#dropdown-menu .dropdown-control {
  padding: 0.5em;
  border-radius: 5px;
  font-size: 0.9em;
  color: #909090;
  border: 1px solid #dedede;
}

#dropdown-menu .dropdown-control {
  display: none;
}

/* ===========================
   Code Component
=========================== */
/* layout */
pre code {
  max-width: 100%;
  display: block;
  overflow-x: auto;
  padding: 1em;
  white-space: pre;
}

pre {
  flex-basis: 100%;
  max-width: 100%;
}

code {
  white-space: nowrap;
}

/* code typography */
code {
  font-family: var(--monospace-font-family);
}

.mac code,
.mac code.hljs,
.win code,
.win code.hljs,
.linux:not(.android) code,
.linux:not(.android) code.hljs {
  font-size: var(--mac-code-font-size-medium);
}
.mac pre code,
.mac pre code.hljs,
.win pre code,
.win pre code.hljs,
.linux:not(.android) pre code,
.linux:not(.android) pre code.hljs {
  font-size: var(--mac-code-font-size-small);
}

.mobile :not(pre) code {
  line-height: 2.15rem;
}

.iphone code,
.iphone code.hljs,
.ipad code,
.ipad code.hljs {
  font-size: var(--ios-code-font-size-medium);
}
.iphone pre code,
.iphone pre code.hljs,
.ipad pre code,
.ipad pre code.hljs {
  font-size: var(--ios-code-font-size-small);
}

.android code,
.android code.hljs {
  font-size: var(--android-code-font-size-medium);
}
.android pre code,
.android pre code.hljs {
  font-size: var(--android-code-font-size-small);
}

code.hljs {
  border-radius: 6px;
}

/* default theme */
/* does not override hljs themes */
.nightMode pre:has(:not(.hljs)) {
  background-color: var(--dark-mode-code-block-background);
  border: 1px solid var(--dark-mode-code-block-background);
}

/* light mode default theme */
pre:has(:not(.hljs)) {
  background-color: var(--light-mode-code-block-background);
  border: 1px solid var(--light-mode-code-block-border);
  border-radius: 6px;
}

.nightMode code:not(.hljs) {
  background: var(--dark-mode-code-block-background);
  border: none;
}

code:not(.hljs):not(pre code) {
  background-color: var(--light-mode-code-block-background);
  border: 1px solid var(--light-mode-code-block-border);
  border-radius: 6px;
  padding: 3px 5px;
}

/* ===========================
   Layout (Positioning and Spacing)
=========================== */
#_flag {
  display: none;
}

html,
.card,
#qa {
  /* Make the html and body take up full height */
  height: min(100%, 100vh);
  max-height: 100vh;
  margin: 0;
}

.card {
  height: min(100%, 100vh);
  display: flex;
  justify-content: center;
}

#main {
  display: flex;
  flex-flow: column;
  justify-content: center;
  align-items: center;
  height: min(100%, 100vh);
  width: min(100%, 100vw);
  max-width: var(--status-bar-width);
}

header,
#status-bar,
#status-bar-buttons {
  width: 100%; /* grow to 100%, then stop at max-width */
  max-width: var(--status-bar-width);
  max-height: 2.95em;
  flex-grow: 1;
}

#flashcard-title {
  overflow-x: auto;
  white-space: nowrap;
  flex-shrink: 0;
  margin-bottom: 1.1875rem;
}

#flashcard-container {
  /* iphone ideal width?
      min-width: 353px;
  */
  width: 478.47px;
  max-width: var(--app-width);
  max-height: 43.0625rem;
  flex-grow: 1;
  padding: 0; /* Remove padding */
  margin: 0;
  display: flex;
  flex-direction: column;
  box-sizing: border-box; /* Use box-sizing: border-box */
}

#flashcard-content {
  max-height: var(--flashcard-content-ideal-max-height);
  overflow-y: auto;
  display: flex;
  box-sizing: border-box; /* use box-sizing in the content */
  padding: 0; /* add back the padding, here */
  margin: 0; /* remove the margin */
}

#flashcard-content,
#flashcard-textbox {
  flex-grow: 1;
}

#flashcard-textbox {
  padding: 2.5rem 2rem;
  display: flex;
  flex-direction: column;
  gap: 1rem;
  min-height: 250px;
  max-width: 100%;
  box-sizing: border-box; /* Also use in the textbox */
}

#flashcard-answer {
  display: flex;
  gap: 0.75em;
  align-items: flex-start;
}

#flashcard-answer:has(pre) {
  flex-flow: row wrap;
}

/* flashcard pictures */
#flashcard-textbox img {
  max-width: 100%;
  max-height: 15rem;
  width: auto;
  height: auto;
  display: block;
  margin: 1rem auto 0 auto;
  border-radius: 12px;
}

#flashcard-textbox img:last-child {
  margin-bottom: 0; /* if nothing comes after img, no spacing needed */
}

#flashcard-source-info {
  margin-top: 2.875rem;
}

.hidden {
  display: none !important;
}

#question-marker,
#question-text,
#answer-text {
  display: inline;
}

#question-text {
  margin: 0;
}

#answer-text {
  margin: 0;
}

#flashcard-content {
  position: relative;
}

/* mobile layout / fixes */
/* not supported for mobile */
.android #status-bar-buttons,
.android #misc-info,
.iphone #status-bar-buttons,
.iphone #misc-info,
.ipad #status-bar-buttons,
.ipad #misc-info {
  display: none;
}

@media (max-width: 480px) {
  #flashcard-container {
    width: 90vw;
  }
  #status-bar,
  #status-bar-buttons {
    width: var(--status-bar-mobile-width);
  }
}
:root {
  /* android material 3 theming */
  --android-light-background: #fcfcfc;
  --android-dark-background: #1a1c1e;
  --android-flashcard-background-light: #fefefe;
  --android-flashcard-background-dark: #242629;
  --android-box-shadow-light: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
  --android-box-shadow-dark: 0 8px 0 #1f2124;
  --android-alt-dark-bg-color: #0f0f0f;
  --android-alt-dark-surface-color: linear-gradient(
    to bottom,
    #1d1d1d,
    #181818
  );
}

/* android layout, based on Pixel 7 testing */
.android #main {
  height: 100vh;
  justify-content: center;
}

.android #status-bar,
.android #status-bar-buttons {
  max-height: 1.5rem;
}

.android #flashcard-content {
  height: 100vh !important;
}

.android #status-bar {
  height: 15vh;
}

/* android renders background to a different color. either fix the background color, or set a new pair:

Backdrop Background: #303030
Flashcard Background: #353535

*/
.android body.card {
  background: var(--android-light-background);
}
.android #flashcard-content {
  max-height: var(--android-ideal-max-height);
  background: var(--android-flashcard-background-light);
  box-shadow: var(--android-box-shadow-light);
}
.android #title {
  font-weight: 500;
}
.android #answer-icon {
  margin: 0;
}
.android .nightMode.card {
  background: var(--android-dark-background);
  background: var(--android-alt-dark-bg-color);
}
.android .nightMode #flashcard-content {
  background: var(--android-flashcard-background-dark);
  box-shadow: var(--android-box-shadow-dark);
  background: var(--android-alt-dark-surface-color);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  background: linear-gradient(135deg, #161618, #1c1c1e);
  box-shadow: 0px 2px 6px rgba(0, 0, 0, 0.3);
  border-radius: 12px;
}

:root {
  --desktop-light-mode-bg: linear-gradient(to bottom, #f8f8f8, #eaeaea);
  --desktop-light-mode-box-shadow: 0px 4px 16px rgba(0, 0, 0, 0.1);
  --desktop-light-mode-border: 1px solid rgba(0, 0, 0, 0.08);
  --desktop-dark-mode-bg: linear-gradient(to bottom, #242424, #1e1e1e);
  --desktop-dark-mode-box-shadow: 0px 8px 24px rgba(0, 0, 0, 0.2);
  --desktop-dark-mode-border: 1px solid rgba(255, 255, 255, 0.08);
}

.mac #flashcard-content,
.win #flashcard-content,
.linux:not(.android) #flashcard-content {
  max-height: var(--mac-flashcard-content-ideal-max-height);
  border-radius: 12px;
  box-shadow: var(--desktop-light-mode-box-shadow);
  border: var(--desktop-light-mode-border);
  background: var(--desktop-light-mode-bg);
}
.mac .nightMode #flashcard-content,
.win .nightMode #flashcard-content,
.linux:not(.android) .nightMode #flashcard-content {
  box-shadow: var(--desktop-dark-mode-box-shadow);
  border: var(--desktop-dark-mode-border);
  background: var(--desktop-dark-mode-bg);
}
.mac .callout,
.win .callout,
.linux:not(.android) .callout {
  font-size: var(--mac-font-size-callout);
  line-height: var(--mac-line-height-callout);
}

:root {
  /* iOS Light & Dark Mode Color Variables */
  --ios-light-background: #f7f7f7;
  --ios-flashcard-background-light: #ffffff;
  --ios-box-shadow-light: 0 4px 6px rgba(0, 0, 0, 0.1);
  --ios-dark-mode-bg: linear-gradient(to bottom, #242424, #1e1e1e);
  --ios-dark-mode-box-shadow: 0px 8px 24px rgba(0, 0, 0, 0.2);
  --ios-dark-mode-border: 1px solid rgba(255, 255, 255, 0.08);
  --ios-border-radius: 12px;
}

.iphone #flashcard-question,
.iphone #flashcard-answer,
.iphone #source-text,
.ipad #flashcard-question,
.ipad #flashcard-answer,
.ipad #source-text {
  text-align: left;
}

/* deck metadata is not supported for ios */
.iphone #flashcard-deck-info,
.ipad #flashcard-deck-info {
  display: none;
}

.iphone .card,
.ipad .card {
  color: var(--light-mode-main-text-color);
  font-family: var(--system-font-family);
  background: var(--ios-light-background);
}
.iphone .card #flashcard-content,
.ipad .card #flashcard-content {
  max-height: var(--iphone-ideal-max-height);
  background: var(--ios-flashcard-background-light);
  box-shadow: var(--ios-box-shadow-light);
  border-radius: var(--ios-border-radius);
}
.iphone .card #flashcard-container,
.ipad .card #flashcard-container {
  padding: 0 0.5em;
}
.iphone .card #flashcard-textbox,
.ipad .card #flashcard-textbox {
  padding: 1.35rem 1.75rem;
}
.iphone .card.nightMode,
.ipad .card.nightMode {
  color: var(--dark-mode-main-text-color);
  background: var(--dark-mode-main-bg-color);
}
.iphone .card.nightMode #flashcard-content,
.ipad .card.nightMode #flashcard-content {
  box-shadow: var(--ios-dark-mode-box-shadow);
  border: var(--ios-dark-mode-border);
  background: var(--ios-dark-mode-bg);
}
.iphone .card.nightMode a,
.ipad .card.nightMode a {
  color: var(--dark-mode-link-accent-color);
}
